<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{front/layouts/main}">
<main layout:fragment="content">
<!--    <h1>결제완료</h1>-->
<style>

    .orderInfo {
        display: grid;
        place-items: center;
        height: 150vh; /* 화면의 높이에 맞춤 */
        font-size: 1.3rem;

    }
    .orderInfoSub {
        width: 50vw;
        margin-top: 10px;
        padding: 0 10px;
        position: relative;
        border: 1px solid;

    }
    .orderInfoSub > div {
        display: flex;
        margin: 10px 0;
        height: 4rem;
        line-height: 4rem;
    }
    .info {
        border-bottom: 1px solid;
    }

    .product > span {
        margin: 0 10px;
    }

    .text_left {
        clear: both;
        width: 15rem;
        text-align: left;
        background: #0001;
    }
    .text_right {
        clear: both;
        height:4rem;
        text-align: center;
<!--        background: #0004;-->
    }


</style>
    <!-- 아마도 _주문상세.html 파일로 필요한 곳에 사용할 수 있게 쓸 듯  -->
    <div class="orderInfo" th:object="${orderInfo}">
        <div class="orderInfoSub">
            <div class="info">
                <h3 th:text="#{주문_정보}"></h3>
            </div>
            <div>
                <span class="text_left" th:text="#{주문번호}"></span>
                <span class="text_right" th:text="*{seq}"></span>
<!--                <td>-->
<!--                    <a th:text="#{구매영수증}" th:href="@{/order/receipt}"></a>-->
<!--                </td>-->
            </div>
            <div>
                <span class="text_left" th:text="#{주문일자}"></span>
                <span class="text_right" th:text="*{createdAt}"></span>
            </div>
            <div>
                <span class="text_left" th:text="#{주문자_이름}"></span>
                <span class="text_right" th:text="*{orderName}"></span>
            </div>
            <div>
                <span class="text_left" th:text="#{주문_상태}"></span>
                <span class="text_right" th:if="*{status == T(org.choongang.order.constants.OrderStatus).ORDER}" th:text="#{OrderStatus.ORDER}"></span>
                <span class="text_right" th:if="*{status == T(org.choongang.order.constants.OrderStatus).PREPARE}" th:text="#{OrderStatus.PREPARE}"></span>
                <span class="text_right" th:if="*{status == T(org.choongang.order.constants.OrderStatus).DELIVERY}" th:text="#{OrderStatus.DELIVERY}"></span>
                <span class="text_right" th:if="*{status == T(org.choongang.order.constants.OrderStatus).ARRIVAL}" th:text="#{OrderStatus.ARRIVAL}"></span>
            </div>
        </div>
        <a href="#" th:attr="onclick='openReceiptPopup(\'' + *{seq} + '\', \'' + *{createdAt} + '\', \'' + *{payPrice} + '\')'">구매 영수증 보기</a>
        <div class="orderInfoSub">
            <div class="info">
                <h3 th:text="#{상품_정보}"></h3>
            </div>
            <div th:each="orderItem : *{orderItems}" class="product">

<!--                    <th:block th:utext="${@utils.printThumb(orderItem.product.listImage, 50, 50, 'product_image')}"></th:block>-->
                <span th:text="${orderItem.product.name}"></span>
                <span th:text="${orderItem.salePrice + '원'}"></span>
                <span th:text="${orderItem.ea + '개'}"></span>
                <span th:text="${orderItem.sdate}"></span>~<span th:text="${orderItem.edate}"></span>
                <span th:text="${'합계 ' + orderItem.totalPrice + '원'}"></span>
            </div>

        </div>

        <div class="orderInfoSub">
            <div class="info">
                <h3 th:text="#{배송지_정보}"></h3>
            </div>
            <div>
                <span class="text_left" th:text="#{받는분_이름}"></span>
                <span class="text_right" th:text="*{receiverName}"></span>
            </div>
            <div>
                <span class="text_left" th:text="#{휴대전화번호}"></span>
                <span class="text_right" th:text="*{receiverCellPhone}"></span>
            </div>
            <div>
                <span class="text_left" th:text="#{배송_주소}"></span>
                <span class="text_right" th:text="*{address + addressSub}"></span>
            </div>
            <div>
                <span class="text_left" th:text="#{주소_상세}"></span>
                <span class="text_right" th:text="*{addressSub}"></span>
            </div>
            <div>
                <span class="text_left" th:text="#{배송메모}"></span>
                <span class="text_right" th:text="*{deliveryMemo}"></span>
            </div>
        </div>
        <div class="orderInfoSub">
            <div>
                <h3 th:text="#{총_금액}"></h3>
            </div>
            <div>
                <span class="text_left" th:text="#{결제금액}"></span>
                <span class="text_right" th:text="*{totalPrice + '(상품합계) + ' +  totalDeliveryPrice + '(배송비) - ' + totalDiscount + '(총 할인금액) = ' + payPrice}"></span>
            </div>
        </div>
    </div>
    <script>
        function openReceiptPopup(param1, param2, param3) {

            var popupWindow = window.open("", "_blank", "width=600,height=400");

            var receiptContent = "주문번호: " + param1 + "<br>결제일: " + param2 + "<br>결제금액: " + param3 + "<br>회사명: SOR<br>서명: _______";
            popupWindow.document.write("<html><head><title>구매 영수증</title></head><body><p>" + receiptContent + "</p></body></html>");
        }
    </script>
</main>
</html>